---
title: '원하는 컴포넌트를 PDF로 저장하는 방법'
publishedAt: '2025-05-04'
summary: 'html2canvas와 jsPDF, 그리고 커스텀 훅 개선기'
tags: ['#react', '#pdf', '#html2canvas', '#jspdf', '#hooks', '#리팩토링']
author: 'Stoic Park'
category: 'react'
readingTime: '5분'
---

# 원하는 컴포넌트를 PDF로 저장하는 방법

**html2canvas와 jsPDF, 그리고 커스텀 훅 리팩토링기**

## 개요

리액트로 화면을 구성하다 보면, 사용자가 보고 있는 UI 그대로를 PDF로 저장해야 할 필요가 생깁니다.
실무에서도 다양한 데이터를 시각화해 사용자에게 제공하는 과정에서 **컴포넌트를 이미지로 캡처하고 PDF로 저장하는 기능**이 요구되었습니다.

초기 방식은 다음과 같은 문제를 안고 있었습니다:

1. PDF 생성 속도가 느리다
2. 그래프·UI 요소의 화질 및 레이아웃 깨지는 경우가 발생한다
3. 백엔드 리소스 부하가 크다

이 글에서는 `html2canvas`와 `jsPDF` 조합으로 **프론트엔드에서 직접 PDF를 생성하는 방식**을 소개하고, 이를 범용 커스텀 훅으로 리팩토링한 과정까지 공유합니다.

---

## 1. 문제 정의: 레거시 방식의 한계

초기 보고서 생성 로직은 이미지 파일 위에 텍스트를 덧씌우는 방식이었습니다.
하지만 다음과 같은 문제점이 있었습니다:

- **해상도 저하**: 특히 차트나 그래프가 흐릿하게 출력됨
- **느린 처리 속도**: 렌더링 시간이 길어 UX 저하
- **백엔드 부담**: 이미지 생성 로직이 서버에서 실행됨

### 해결 목표

- 사용자가 보는 **UI 그대로**를 PDF로 저장
- **고해상도 대응**으로 이미지 품질 보장
- 백엔드 리소스를 소모하지 않는 **프론트 중심 구조**

---

## 2. 해결 전략: 프론트엔드에서 직접 PDF 생성

### 사용 기술

- [`html2canvas`](https://www.npmjs.com/package/html2canvas): DOM 요소를 캡처하여 이미지로 변환
- [`jsPDF`](https://www.npmjs.com/package/jspdf): 이미지를 PDF로 저장
- `window.devicePixelRatio`: 고해상도 디바이스 대응

---

## 3. 초기 구현: 도메인 종속 커스텀 훅

```tsx
const useReportDownload = ({
  companyId,
  siteId,
  assetId,
  diagnosisDate,
  ref,
}) => {
  const reportData = useReportData({ ... });

  const download = async () => {
    const canvas = await html2canvas(ref.current);
    const pdf = new jsPDF();
    pdf.addImage(canvas.toDataURL(), 'JPEG', 0, 0, 210, 297);
    pdf.save('보고서.pdf');
  };

  return { download };
};
문제점
도메인 종속: 다른 화면에서 재사용 불가

관심사 결합: 데이터 패칭과 UI 캡처가 뒤섞임

4. 리팩토링 방향
이 기능은 사실 보고서 외에도 여러 곳에서 필요했습니다.
따라서 다음과 같은 목표를 세웠습니다:

도메인 제거

기능 중심의 이름 부여 (usePdfDownload)

외부에서 ref, filename, onBeforeDownload 주입 가능

5. 개선된 커스텀 훅: usePdfDownload
tsx
복사
편집
export const usePdfDownload = <T extends HTMLElement>({
 ref,
 filename = 'document.pdf',
 onBeforeDownload,
}: {
 ref: RefObject<T>
 filename?: string
 onBeforeDownload?: () => Promise<void> | void
}) => {
  const download = async () => {
    if (onBeforeDownload) await onBeforeDownload();

    const canvas = await html2canvas(ref.current, {
      scale: window.devicePixelRatio,
    });

    const pdf = new jsPDF();
    const imgData = canvas.toDataURL('image/jpeg');
    pdf.addImage(imgData, 'JPEG', 0, 0, 210, 297);
    pdf.save(filename);
  };

  return { download };
};
사용 예시
tsx
복사
편집
const { download } = usePdfDownload({
  ref,
  filename: '내보내기.pdf',
});
데이터 로딩 후 캡처하는 경우:

tsx
복사
편집
const { download } = usePdfDownload({
  ref,
  onBeforeDownload: async () => {
    await fetchData();
  },
});
6. 결과 요약
시각적 품질 향상: 고해상도에서도 깔끔하게 출력

성능 개선: 프론트 단에서 처리해 속도 향상

범용성 확보: 다양한 UI에 재사용 가능

유지보수 용이: 관심사 분리 구조

7. 데모
아래 박스를 PDF로 저장해보세요.

<DemoPdfBox />
📄 저장된 PDF에는 이 박스 안의 텍스트와 스타일이 그대로 담깁니다.

8. 마무리하며
도메인과 기능의 분리 설계는 재사용성과 유지보수를 비약적으로 높입니다.

작은 기능도 관심사 분리 원칙에 따라 설계하면 자연스럽게 확장성이 생깁니다.

실무에서 생긴 문제를 기능으로 전환하고 개선해나가는 과정이 개발자에게 가장 좋은 공부입니다.

비슷한 요구가 있다면, html2canvas + jsPDF 조합과 커스텀 훅 방식으로 접근해보세요.
```
